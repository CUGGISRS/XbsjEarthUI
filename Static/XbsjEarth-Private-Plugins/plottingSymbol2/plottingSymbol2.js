!function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,i){!function(e,t){if(!C[e]||!v[e])return;for(var i in v[e]=!1,t)Object.prototype.hasOwnProperty.call(t,i)&&(m[i]=t[i]);0==--g&&0===S&&P()}(e,i),t&&t(e,i)};var i,r=!0,o="276d1caefd5bf6df7a4d",s={},n=[],a=[];function l(e){var t=z[e];if(!t)return I;var r=function(r){return t.hot.active?(z[r]?-1===z[r].parents.indexOf(e)&&z[r].parents.push(e):(n=[e],i=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),n=[]),I(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return I[e]},set:function(t){I[e]=t}}};for(var s in I)Object.prototype.hasOwnProperty.call(I,s)&&"e"!==s&&"t"!==s&&Object.defineProperty(r,s,o(s));return r.e=function(e){return"ready"===p&&d("prepare"),S++,I.e(e).then(t,(function(e){throw t(),e}));function t(){S--,"prepare"===p&&(w[e]||E(e),0===S&&0===g&&P())}},r.t=function(e,t){return 1&t&&(e=r(e)),I.t(e,-2&t)},r}function h(t){var r={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:i!==t,active:!0,accept:function(e,t){if(void 0===e)r._selfAccepted=!0;else if("function"==typeof e)r._selfAccepted=e;else if("object"==typeof e)for(var i=0;i<e.length;i++)r._acceptedDependencies[e[i]]=t||function(){};else r._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)r._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)r._declinedDependencies[e[t]]=!0;else r._declinedDependencies[e]=!0},dispose:function(e){r._disposeHandlers.push(e)},addDisposeHandler:function(e){r._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=r._disposeHandlers.indexOf(e);t>=0&&r._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,p){case"idle":(m={})[t]=e[t],d("ready");break;case"ready":O(t);break;case"prepare":case"check":case"dispose":case"apply":(y=y||[]).push(t)}},check:M,apply:b,status:function(e){if(!e)return p;c.push(e)},addStatusHandler:function(e){c.push(e)},removeStatusHandler:function(e){var t=c.indexOf(e);t>=0&&c.splice(t,1)},data:s[t]};return i=void 0,r}var c=[],p="idle";function d(e){p=e;for(var t=0;t<c.length;t++)c[t].call(null,e)}var u,m,f,y,g=0,S=0,w={},v={},C={};function _(e){return+e+""===e?+e:e}function M(e){if("idle"!==p)throw new Error("check() is only allowed in idle status");return r=e,d("check"),(t=1e4,t=t||1e4,new Promise((function(e,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var r=new XMLHttpRequest,s=I.p+""+o+".hot-update.json";r.open("GET",s,!0),r.timeout=t,r.send(null)}catch(e){return i(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)i(new Error("Manifest request to "+s+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)i(new Error("Manifest request to "+s+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void i(e)}e(t)}}}))).then((function(e){if(!e)return d(x()?"ready":"idle"),null;v={},w={},C=e.c,f=e.h,d("prepare");var t=new Promise((function(e,t){u={resolve:e,reject:t}}));m={};return E(0),"prepare"===p&&0===S&&0===g&&P(),t}));var t}function E(e){C[e]?(v[e]=!0,g++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=I.p+""+e+"."+o+".hot-update.js",document.head.appendChild(t)}(e)):w[e]=!0}function P(){d("ready");var e=u;if(u=null,e)if(r)Promise.resolve().then((function(){return b(r)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var i in m)Object.prototype.hasOwnProperty.call(m,i)&&t.push(_(i));e.resolve(t)}}function b(t){if("ready"!==p)throw new Error("apply() is only allowed in ready status");return function t(r){var a,l,h,c,p;function u(e){for(var t=[e],i={},r=t.map((function(e){return{chain:[e],id:e}}));r.length>0;){var o=r.pop(),s=o.id,n=o.chain;if((c=z[s])&&(!c.hot._selfAccepted||c.hot._selfInvalidated)){if(c.hot._selfDeclined)return{type:"self-declined",chain:n,moduleId:s};if(c.hot._main)return{type:"unaccepted",chain:n,moduleId:s};for(var a=0;a<c.parents.length;a++){var l=c.parents[a],h=z[l];if(h){if(h.hot._declinedDependencies[s])return{type:"declined",chain:n.concat([l]),moduleId:s,parentId:l};-1===t.indexOf(l)&&(h.hot._acceptedDependencies[s]?(i[l]||(i[l]=[]),g(i[l],[s])):(delete i[l],t.push(l),r.push({chain:n.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];-1===e.indexOf(r)&&e.push(r)}}x();var S={},w=[],v={},M=function(){console.warn("[HMR] unexpected require("+P.moduleId+") to disposed module")};for(var E in m)if(Object.prototype.hasOwnProperty.call(m,E)){var P;p=_(E),P=m[E]?u(p):{type:"disposed",moduleId:E};var b=!1,O=!1,T=!1,A="";switch(P.chain&&(A="\nUpdate propagation: "+P.chain.join(" -> ")),P.type){case"self-declined":r.onDeclined&&r.onDeclined(P),r.ignoreDeclined||(b=new Error("Aborted because of self decline: "+P.moduleId+A));break;case"declined":r.onDeclined&&r.onDeclined(P),r.ignoreDeclined||(b=new Error("Aborted because of declined dependency: "+P.moduleId+" in "+P.parentId+A));break;case"unaccepted":r.onUnaccepted&&r.onUnaccepted(P),r.ignoreUnaccepted||(b=new Error("Aborted because "+p+" is not accepted"+A));break;case"accepted":r.onAccepted&&r.onAccepted(P),O=!0;break;case"disposed":r.onDisposed&&r.onDisposed(P),T=!0;break;default:throw new Error("Unexception type "+P.type)}if(b)return d("abort"),Promise.reject(b);if(O)for(p in v[p]=m[p],g(w,P.outdatedModules),P.outdatedDependencies)Object.prototype.hasOwnProperty.call(P.outdatedDependencies,p)&&(S[p]||(S[p]=[]),g(S[p],P.outdatedDependencies[p]));T&&(g(w,[P.moduleId]),v[p]=M)}var R,j=[];for(l=0;l<w.length;l++)p=w[l],z[p]&&z[p].hot._selfAccepted&&v[p]!==M&&!z[p].hot._selfInvalidated&&j.push({module:p,parents:z[p].parents.slice(),errorHandler:z[p].hot._selfAccepted});d("dispose"),Object.keys(C).forEach((function(e){!1===C[e]&&function(e){delete installedChunks[e]}(e)}));var W,V,D=w.slice();for(;D.length>0;)if(p=D.pop(),c=z[p]){var X={},H=c.hot._disposeHandlers;for(h=0;h<H.length;h++)(a=H[h])(X);for(s[p]=X,c.hot.active=!1,delete z[p],delete S[p],h=0;h<c.children.length;h++){var k=z[c.children[h]];k&&((R=k.parents.indexOf(p))>=0&&k.parents.splice(R,1))}}for(p in S)if(Object.prototype.hasOwnProperty.call(S,p)&&(c=z[p]))for(V=S[p],h=0;h<V.length;h++)W=V[h],(R=c.children.indexOf(W))>=0&&c.children.splice(R,1);d("apply"),void 0!==f&&(o=f,f=void 0);for(p in m=void 0,v)Object.prototype.hasOwnProperty.call(v,p)&&(e[p]=v[p]);var L=null;for(p in S)if(Object.prototype.hasOwnProperty.call(S,p)&&(c=z[p])){V=S[p];var G=[];for(l=0;l<V.length;l++)if(W=V[l],a=c.hot._acceptedDependencies[W]){if(-1!==G.indexOf(a))continue;G.push(a)}for(l=0;l<G.length;l++){a=G[l];try{a(V)}catch(e){r.onErrored&&r.onErrored({type:"accept-errored",moduleId:p,dependencyId:V[l],error:e}),r.ignoreErrored||L||(L=e)}}}for(l=0;l<j.length;l++){var N=j[l];p=N.module,n=N.parents,i=p;try{I(p)}catch(e){if("function"==typeof N.errorHandler)try{N.errorHandler(e)}catch(t){r.onErrored&&r.onErrored({type:"self-accept-error-handler-errored",moduleId:p,error:t,originalError:e}),r.ignoreErrored||L||(L=t),L||(L=e)}else r.onErrored&&r.onErrored({type:"self-accept-errored",moduleId:p,error:e}),r.ignoreErrored||L||(L=e)}}if(L)return d("fail"),Promise.reject(L);if(y)return t(r).then((function(e){return w.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e}));return d("idle"),new Promise((function(e){e(w)}))}(t=t||{})}function x(){if(y)return m||(m={}),y.forEach(O),y=void 0,!0}function O(t){Object.prototype.hasOwnProperty.call(m,t)||(m[t]=e[t])}var z={};function I(t){if(z[t])return z[t].exports;var i=z[t]={i:t,l:!1,exports:{},hot:h(t),parents:(a=n,n=[],a),children:[]};return e[t].call(i.exports,i,i.exports,l(t)),i.l=!0,i.exports}I.m=e,I.c=z,I.d=function(e,t,i){I.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},I.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},I.t=function(e,t){if(1&t&&(e=I(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(I.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)I.d(i,r,function(t){return e[t]}.bind(null,r));return i},I.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return I.d(t,"a",t),t},I.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},I.p="",I.h=function(){return o},l(0)(I.s=0)}([function(e,t,i){"use strict";i.r(t);class r extends XE.Obj.PlotBase{constructor(e,t){super(e,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,XE.MVVM.extend(this,{_polygonShow:!0}),this._polygon=new XE.Obj.Polygon(e),this.disposers.push(()=>{this._polygon=this._polygon&&this._polygon.destroy()}),this._polygon.show=this._polygonShow&&this.show,XE.Earth.Interaction.Picking.registerPickingParent(this._polygon,this);const i=()=>{this._polygon.show=this._polygonShow&&this.show,this._polygon.width=this.width,this._polygon.color=this.color,this._polygon.ground=this.ground,this._polygon.outline.width=this.outlineWidth,this._polygon.outline.color=this.outlineColor,this._polygon.outline.show=this.outlineShow,this._polygon.depthTest=this.depthTest};i(),this.disposers.push(XE.MVVM.watch(()=>({show:this._polygonShow&&this.show,width:this.width,color:[...this.color],ground:this.ground,outlineWidth:this.outlineWidth,outlineColor:this.outlineColor,outlineShow:this.outlineShow,depthTest:this.depthTest}),()=>i()))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polygon.flyTo()}}r.defaultOptions={positions:[],show:!0,color:[0,1,0,.1],outlineWidth:2,outlineColor:[0,1,0,1],outlineShow:!0,depthTest:!1};var o=r;const s=XE.Tool;class n extends o{constructor(e,t){super(e,t),this._onlyMove=!0,this._polygonPositions=[],this.disposers.push(XE.MVVM.watch(()=>({minWidthScale:this.minWidthScale,dynamicWidthScale:this.dynamicWidthScale,arrowMaxHeightScale:this.arrowMaxHeightScale,arrowWingWidthScale:this.arrowWingWidthScale}),()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)})),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(e=>[...e])],()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)}))}change(e,t=.06,i=.1,r=.1,o=2){let n=[...e];const a=n.length;if(a<2||h(n[a-1],n[a-2]))return;console.clear=function(){};let l=n.map(e=>Cesium.Cartesian3.fromRadians(...e,null,new Cesium.Cartesian3));this._polygonPositions.length=0;let c,p,d,u,m,f,y,g=[0,0,0],S=new Array(a).fill(0).map((e,t)=>(c=n[t-1],p=n[t+1],d=n[t],u=c?s.Math.hpr(d,c,g)[0]:0,m=p?s.Math.hpr(d,p,g)[0]:0,f=u&&m?2:1,y=(u+m)/f,y=u>m?y:y-Cesium.Math.PI,y<0?y+Cesium.Math.TWO_PI:y)),w=0,v=[];l.forEach((e,t)=>{c=l[t-1]||e,p=e,w+=Cesium.Cartesian3.distance(c,p),v.push(w)}),v=v.map(e=>w-e);const C=(i/=2)*w,_=(t/=2)*w;let M=new Array(v.length).fill(0).map((e,t)=>_+C*v[t]/w),E=function(e,t,i,r,o,n){let a=e*t,l=.7*a,h=Cesium.Cartesian3.distance(o[0],o[1]);h<l&&(l=h,a=l/.7);let c=s.Math.hpr(n[1],n[0],[0,0,0])[0],p=s.Math.geoMove(n[1],c,l,[0,0,0]),d=s.Math.geoMove(n[1],c,a,[0,0,0]),u=s.Math.hpr(p,n[1],[0,0,0])[0],m=s.Math.hpr(d,n[1],[0,0,0])[0],f=new Array(5);return f[0]=s.Math.geoMove(p,u-Cesium.Math.PI_OVER_TWO,i,[0,0,0]),f[4]=s.Math.geoMove(p,u+Cesium.Math.PI_OVER_TWO,i,[0,0,0]),f[1]=s.Math.geoMove(d,m-Cesium.Math.PI_OVER_TWO,i*r,[0,0,0]),f[3]=s.Math.geoMove(d,m+Cesium.Math.PI_OVER_TWO,i*r,[0,0,0]),f[2]=[...n[1]],f}(w,r,_,o,l.slice(-2),n.slice(-2)),P=[],b=[];n.forEach((e,t)=>{0==t||t==a-1?(P.push(s.Math.geoMove(e,S[t]+Cesium.Math.PI_OVER_TWO,M[t])),b.push(s.Math.geoMove(e,S[t]-Cesium.Math.PI_OVER_TWO,M[t]))):(P.push(s.Math.geoMove(e,S[t]-Cesium.Math.PI,M[t])),b.push(s.Math.geoMove(e,S[t],M[t])))}),P.pop(),b.pop(),P.push(E[0]),b.push(E[E.length-1]);let x=s.Math.interpolatePositions(P,20*a,!1,[]),O=s.Math.interpolatePositions(b,20*a,!1,[]);x.forEach(e=>{this._polygonPositions.push(e[0],e[1])}),E.forEach(e=>{this._polygonPositions.push(e[0],e[1])});for(let e=O.length-1;e>=0;e--)this._polygonPositions.push(O[e][0],O[e][1]);this._polygon.positions=this._polygonPositions,this._polygon.height=0,this._polygonShow=!0}}n.registerType(n,"GeoArrow"),n.defaultOptions={minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.1,arrowWingWidthScale:2};var a=n;let l;function h(e,t){if(!e||!t)return!1;l=0;for(let i=0;i<e.length;i++)if(l=e[i]==t[i]?0:1,l>0)return!1;return!0}let c=new Cesium.Cartesian3;XE.Tool;class p extends XE.Core.XbsjCzmObj{constructor(e,t){super(e,t);let i=e.czm.viewer,r=new Cesium.Cartesian3;Cesium.Cartesian3.fromRadians(...this.position,null,r);let o=Cesium.Transforms.eastNorthUpToFixedFrame(r);this.particleSystem=new Cesium.ParticleSystem({image:this.image,startColor:Cesium.Color.LIGHTSEAGREEN.withAlpha(.7),endColor:Cesium.Color.WHITE.withAlpha(0),startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:o,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:new Cesium.CircleEmitter(2),updateCallback:()=>{}}),i.scene.primitives.add(this.particleSystem),this.disposers.push(XE.MVVM.watch(()=>({startColorRgb:{...this.startColorRgb},endColorRgb:{...this.endColorRgb},startAlpha:{...this.startAlpha},endAlpha:{...this.endAlpha}}),()=>this.updateColor())),this.disposers.push(XE.MVVM.watch(()=>({startColorRgb:{...this.startColorRgb},endColorRgb:{...this.endColorRgb},startAlpha:{...this.startAlpha},endAlpha:{...this.endAlpha}}),()=>this.updateColor())),this.disposers.push(XE.MVVM.watch(()=>({image:this.image,emissionRate:this.emissionRate,maximumSpeed:this.maximumSpeed,minimumSpeed:this.minimumSpeed,minimumImageSize:this.minimumImageSize,maximumImageSize:this.maximumImageSize,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife}),()=>this.update())),this.disposers.push(XE.MVVM.watch(()=>({particleSize:this.particleSize}),()=>this.updateParticleSize())),this.disposers.push(XE.MVVM.watch(()=>[...this.position],()=>this.updateMatrix())),this.disposers.push(XE.MVVM.watch(()=>({gravity:this.gravity}),()=>{this.particleSystem.updateCallback=this.updateGravity(this.gravity)})),this.disposers.push(XE.MVVM.watch(()=>({emitterRadius:this.emitterRadius,emitterAngle:this.emitterAngle,emitterType:this.emitterType}),()=>this.updateEmitter()))}updateMatrix(){let e=new Cesium.Cartesian3;Cesium.Cartesian3.fromRadians(...this.position,null,e),this.rotate||(this.particleSystem.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(e))}updateColor(){this.particleSystem.startColor=Cesium.Color.fromAlpha(this.startColorRgb,this.startAlpha,new Cesium.Color),this.particleSystem.endColor=Cesium.Color.fromAlpha(this.endColorRgb,this.endAlpha,new Cesium.Color)}updateParticleSize(){this.particleSystem.imageSize?(this.particleSystem.imageSize.x=this.particleSize,this.particleSystem.imageSize.y=this.particleSize,this.particleSystem.maximumImageSize.x=this.particleSize,this.particleSystem.maximumImageSize.y=this.particleSize,this.particleSystem.minimumImageSize.x=this.particleSize,this.particleSystem.minimumImageSize.y=this.particleSize):this.particleSystem.imageSize=new Cesium.Cartesian2(this.particleSize,this.particleSize)}update(){this.particleSystem.image=this.image,this.particleSystem.startColor=this.startColor,this.particleSystem.endColor=this.endColor,this.particleSystem.startScale=this.startScale,this.particleSystem.endScale=this.endScale,this.particleSystem.emissionRate=this.emissionRate,this.particleSystem.minimumSpeed=this.minimumSpeed,this.particleSystem.maximumSpeed=this.maximumSpeed,this.particleSystem.image=this.image}updateGravity(e){return(t,i)=>{Cesium.Cartesian3.normalize(t.position,c),Cesium.Cartesian3.multiplyByScalar(c,e*i,c),t.velocity=Cesium.Cartesian3.add(t.velocity,c,t.velocity)}}updateEmitter(){let e;if(e="BoxEmitter"!=this.emitterType?"ConeEmitter"==this.emitterType?this.emitterAngle:this.emitterRadius:new Cesium.Cartesian3(...new Array(3).fill(this.emitterRadius)),!this.particleSystem)return new Cesium[this.emitterType](e);this.particleSystem.emitter=new Cesium[this.emitterType](e)}flyTo(){if(this.particleSystem){let e=setInterval(()=>{if(0!=this.particleSystem._particles.length){clearInterval(e);let t=this.computeBoundingSphere();viewer.camera.flyToBoundingSphere(t,{duration:2})}},100)}}computeBoundingSphere(){let e,t={x:-1/0,y:-1/0,z:-1/0},i={x:1/0,y:1/0,z:1/0};this.particleSystem._particles&&this.particleSystem._particles.length&&this.particleSystem._particles.forEach(r=>{e=r.position,t.x=t.x>e.x?t.x:e.x,t.y=t.y>e.y?t.y:e.y,t.z=t.z>e.z?t.z:e.z,i.x=i.x<e.x?i.x:e.x,i.y=i.y<e.y?i.y:e.y,i.z=i.z<e.z?i.z:e.z});let r=Cesium.Cartesian3.midpoint(t,i,new Cesium.Cartesian3),o=Cesium.Cartesian3.distance(t,r);return new Cesium.BoundingSphere(r,o)}}p.defaultOptions={startColorRgb:{red:.12549,green:.69804,blue:.66667},endColorRgb:{red:1,green:1,blue:1},startAlpha:.7,endAlpha:0,position:[1.6988083400554626,.6666896940162155,0],rotate:[0,0,0],emissionRate:5,gravity:0,minimumParticleLife:12,maximumParticleLife:12,minimumSpeed:1,maximumSpeed:4,startScale:1,endScale:5,particleSize:25,image:"../../XbsjEarth-Plugins/plottingSymbol2/assets/SampleData/smoke.png",emitterRadius:2,emitterAngle:1,emitterType:"CircleEmitter"},p.registerType(p,"ParticleSystem");var d=p;const u=XE.Tool;class m extends o{constructor(e,t){super(e,t),this._pgPositions=[],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(e=>[...e])],e=>{const t=e.length;if(t<=2)return;this._pgPositions.length=0;let i=[];e.forEach(e=>{i.push(e)}),u.Math.interpolatePositions(i,20*(t+1)-1,!0,[]).forEach(e=>{this._pgPositions.push(e[0],e[1])}),this._polygon.positions=this._pgPositions,this._polygon.height=e[0][2]}))}}m.registerType(m,"GeoSmoothPolygon");var f=m;XE.Obj.Plots=XE.Obj.Plots||{},XE.Obj.Plots.GeoArrow=a,XE.Obj.Plots.ParticleSystem=d,XE.Obj.Plots.GeoSmoothPolygon=f}]);
//# sourceMappingURL=plottingSymbol2.js.map